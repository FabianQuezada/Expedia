<app-navbar></app-navbar>

<div class="container py-5">
  <form *ngIf="formulario" [formGroup]="formulario" (ngSubmit)="reservar()" class="card shadow p-4">

    <!-- ENCARGADO DE LA RESERVA -->
    <section class="mb-5">
      <h3 class="mb-4"><i class="bi bi-person-badge-fill me-2"></i>Encargado de la reserva</h3>
      <div [formGroup]="encargadoGroup" class="border rounded p-3">
        <div class="mb-3">
          <label>Nombre completo:</label>
          <input type="text" class="form-control" formControlName="nombre" placeholder="Ej: Juan Pérez"
            [class.is-invalid]="campoInvalido('encargado.nombre')" />
          <div class="invalid-feedback">Solo letras. Obligatorio.</div>
        </div>

        <div class="mb-3">
          <label>Correo electrónico:</label>
          <input type="email" class="form-control" formControlName="correo" placeholder="correo@ejemplo.com"
            [class.is-invalid]="campoInvalido('encargado.correo')" />
          <div class="invalid-feedback">Correo no válido.</div>
        </div>

        <div class="mb-3">
          <label>Teléfono:</label>
          <input type="text" class="form-control" formControlName="telefono" placeholder="912345678" inputmode="numeric"
            pattern="[0-9]*" (keydown)="soloNumeros($event)" [class.is-invalid]="campoInvalido('encargado.telefono')" />
        </div>
      </div>

      <!-- RESUMEN DE PERSONAS -->
      <section class="mt-4">
        <h5 class="fw-semibold text-primary">
          <i class="bi bi-people-fill"></i> Personas que viajan:
        </h5>
        <ul class="list-group">
          <li class="list-group-item">
            <i class="bi bi-person-fill text-dark me-2 fs-5"></i>
            Adultos: {{ datosRecibidos.adultos }}
          </li>
          <li class="list-group-item">
            <i class="bi bi-person-circle text-dark me-2 fs-5"></i>
            Niños: {{ datosRecibidos.ninos }}
          </li>
        </ul>
      </section>
    </section>

    <!-- MÉTODO DE PAGO (COMPONENTE SEPARADO) -->
    <section class="mb-5">
      <app-metodo-pago
        [formulario]="formulario"
        [metodoSeleccionado]="metodoSeleccionado"
        [mostrarFormulario]="mostrarFormulario"
        (seleccionCambio)="seleccionarMetodo($event)"
      ></app-metodo-pago>
    </section>

    <!-- RESUMEN -->
    <section class="mb-4">
      <h3 class="mb-3"><i class="bi bi-clipboard-check me-2"></i>Resumen de la experiencia</h3>
      <ul class="list-group">
        <li class="list-group-item">Ubicación: {{ datosRecibidos.ciudad }}</li>
        <li class="list-group-item">Experiencia: {{ datosRecibidos.titulo }}</li>
        <li class="list-group-item">Fecha: {{ datosRecibidos.fecha }}</li>
        <li class="list-group-item">Hora: {{ datosRecibidos.hora }}</li>
        <li class="list-group-item fw-bold">
          Total experiencia: CLP {{ datosRecibidos.total }}
        </li>
      </ul>
    </section>

    <!-- BOTÓN -->
    <button type="submit" class="btn btn-primary w-100 fs-5" [disabled]="formulario.invalid">
      <i class="bi bi-check-circle-fill me-2"></i>Reservar
    </button>
  </form>
</div>
