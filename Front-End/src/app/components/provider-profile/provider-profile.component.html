<app-navbar></app-navbar>
<div class="container my-4">
  <div class="row">
    <!-- PANEL IZQUIERDO -->
    <div class="col-md-3">
      <div class="left-panel">
        <div class="mb-3">
          <h5 class="fw-semibold">{{ provider.nombreEmpresa }}</h5>
          <p class="text-muted small">{{ provider.correo }}</p>
          <p class="small">
            Administra tu perfil y configuraciones en un solo lugar
          </p>
        </div>

        <div class="d-flex flex-column gap-3">
          <button
            class="btn-opciones"
            [ngClass]="{ active: seccionSeleccionada === 'perfil' }"
            (click)="seccionSeleccionada = 'perfil'"
          >
            <i class="bi bi-person fs-4 mt-1"></i>
            <div class="d-flex flex-column justify-content-center">
              <div class="fw-semibold">Perfil</div>
              <div class="text-muted subtitulo">
                Ingresa tus datos personales y documentos de viaje
              </div>
            </div>
          </button>

          <button
            class="btn-opciones"
            [ngClass]="{ active: seccionSeleccionada === 'servicios' }"
            (click)="mostrarServicios()"
          >
            <i class="bi bi-briefcase fs-4 mt-1"></i>
            <div class="d-flex flex-column justify-content-center">
              <div class="fw-semibold">Mis Servicios</div>
              <div class="text-muted subtitulo">
                Gestiona las experiencias que ofreces
              </div>
            </div>
          </button>

          <button
            class="btn-opciones"
            [ngClass]="{ active: seccionSeleccionada === 'notificaciones' }"
            (click)="seccionSeleccionada = 'notificaciones'"
          >
            <i class="bi bi-bell fs-4 mt-1"></i>
            <div class="d-flex flex-column justify-content-center">
              <div class="fw-semibold">Notificaciones</div>
              <div class="text-muted subtitulo">
                Elige las notificaciones que quieres recibir
              </div>
            </div>
          </button>

          <button
            class="btn-opciones"
            [ngClass]="{ active: seccionSeleccionada === 'ayudaComentarios' }"
            (click)="seccionSeleccionada = 'ayudaComentarios'"
          >
            <i class="bi bi-question-circle fs-4 mt-1"></i>
            <div class="d-flex flex-column justify-content-center">
              <div class="fw-semibold">Ayuda y comentarios</div>
              <div class="text-muted subtitulo">Obtén asistencia</div>
            </div>
          </button>

          <button class="btn-opciones">
            <i class="bi bi-box-arrow-right fs-4 mt-1"></i>
            <div class="d-flex flex-column justify-content-center">
              <div class="fw-semibold">Cerrar Sesión</div>
              <div class="text-muted subtitulo">
                Salir de tu cuenta de forma segura
              </div>
            </div>
          </button>
        </div>
      </div>
    </div>

    <!-- PANEL DERECHO -->
    <div class="col-md-9">
      <div class="right-panel card p-4">
        <!-- PERFIL -->
        <ng-container *ngIf="seccionSeleccionada === 'perfil'">
          <h4 class="fw-bold">{{ provider.nombreEmpresa }}</h4>
          <hr class="mb-4" />

          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="fw-semibold">Información Básica</h5>
            <button
              class="btn btn-link p-0"
              (click)="editarPerfil = !editarPerfil"
            >
              {{ editarPerfil ? "Cancelar" : "Editar" }}
            </button>
          </div>

          <form *ngIf="editarPerfil; else verPerfil" [formGroup]="formPerfil">
            <div class="row">
              <div class="col-md-6">
                <label for="nombreEmpresa" class="form-label"
                  ><strong>Nombre</strong></label
                >
                <input
                  id="nombreEmpresa"
                  type="text"
                  class="form-control"
                  formControlName="nombreEmpresa"
                  placeholder="Ingrese nombre de la empresa"
                  title="Nombre de la empresa"
                />
              </div>
              <div class="col-md-6">
                <label for="descripcion" class="form-label"
                  ><strong>Descripción</strong></label
                >
                <input
                  id="descripcion"
                  type="text"
                  class="form-control"
                  formControlName="descripcion"
                  placeholder="Descripción del proveedor"
                  title="Descripción del proveedor"
                />
              </div>
            </div>

            <div class="row mt-3">
              <div class="col-md-6">
                <label for="correo" class="form-label"
                  ><strong>Correo</strong></label
                >
                <input
                  id="correo"
                  type="email"
                  class="form-control"
                  formControlName="correo"
                  placeholder="correo@ejemplo.com"
                  title="Correo electrónico"
                />
                <div
                  class="text-danger small mt-1"
                  *ngIf="
                    formPerfil.get('correo')?.invalid &&
                    formPerfil.get('correo')?.touched
                  "
                >
                  <div *ngIf="formPerfil.get('correo')?.errors?.['required']">
                    El correo es obligatorio.
                  </div>
                  <div *ngIf="formPerfil.get('correo')?.errors?.['email']">
                    Formato de correo inválido.
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <label for="numeroTelefono" class="form-label"
                  ><strong>Número de teléfono</strong></label
                >
                <input
                  id="numeroTelefono"
                  type="text"
                  class="form-control"
                  formControlName="numeroTelefono"
                  placeholder="+56912345678"
                  title="Número de teléfono"
                />
                <div
                  class="text-danger small mt-1"
                  *ngIf="
                    formPerfil.get('numeroTelefono')?.invalid &&
                    formPerfil.get('numeroTelefono')?.touched
                  "
                >
                  <div
                    *ngIf="formPerfil.get('numeroTelefono')?.errors?.['required']"
                  >
                    El número de teléfono es obligatorio.
                  </div>
                  <div
                    *ngIf="formPerfil.get('numeroTelefono')?.errors?.['pattern']"
                  >
                    Número de teléfono inválido.
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-3">
              <button
                type="button"
                class="btn btn-primary me-2"
                (click)="guardarPerfil()"
                [disabled]="formPerfil.invalid"
              >
                Guardar
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                (click)="editarPerfil = false"
              >
                Cancelar
              </button>
            </div>
          </form>

          <ng-template #verPerfil>
            <div class="row">
              <div class="col-md-6">
                <p><strong>Nombre</strong></p>
                <p>{{ provider.nombreEmpresa }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Descripción</strong></p>
                <p>{{ provider.descripcion }}</p>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <p><strong>Correo</strong></p>
                <p>{{ provider.correo || "Sin información" }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Número de teléfono</strong></p>
                <p>{{ provider.numeroTelefono || "Sin información" }}</p>
              </div>
            </div>
          </ng-template>

          <div class="row mt-3">
            <div class="col-md-6">
              <p><strong>Fecha de Registro</strong></p>
              <p>{{ provider.fechaRegistro }}</p>
            </div>
            <div class="col-md-6">
              <p><strong>Calificación</strong></p>
              <p>{{ provider.calificacion }}</p>
            </div>
          </div>
        </ng-container>

        <!-- MIS SERVICIOS -->
        <ng-container *ngIf="seccionSeleccionada === 'servicios'">
          <div
            class="servicios-header d-flex align-items-center justify-content-between mb-3"
          >
            <h4 class="fw-bold mb-3">Mis Servicios</h4>
            <button class="btn-agregar-servicio">Añadir Servicio</button>
          </div>

          <div *ngIf="(servicios?.length || 0) > 0; else sinServicios">
            <div
              *ngFor="let servicio of servicios"
              class="servicio-card d-flex mb-3 shadow-sm rounded"
            >
              <div>
                <img
                  [src]="servicio.imagen"
                  alt="Imagen del servicio"
                  class="servicio-img"
                />
              </div>
              <div
                class="p-3 d-flex flex-column justify-content-between flex-grow-1"
              >
                <div>
                  <h5 class="mb-1 fw-bold">{{ servicio.nombre }}</h5>
                  <p class="mb-2">{{ servicio.descripcion }}</p>
                </div>
                <div class="precio-editar-container">
                  <p class="mb-0 precio">
                    CLP {{ servicio.precio.toLocaleString("es-CL") }}
                  </p>
                  <button class="btn-editar" (click)="mostrarDetalle(servicio)">
                    Ver
                  </button>
                </div>
              </div>
            </div>
          </div>

          <ng-template #sinServicios>
            <p>No tienes servicios registrados aún.</p>
          </ng-template>
        </ng-container>

        <!-- DETALLE SERVICIO -->
        <ng-container
          *ngIf="
            seccionSeleccionada === 'detalleServicio' && servicioSeleccionado
          "
        >
          <h4 class="fw-bold mb-3">Mis Servicios</h4>
          <div class="fixed-height-scroll">
            <app-view-service
              [servicio]="servicioSeleccionado"
            ></app-view-service>
          </div>
        </ng-container>

        <!-- NOTIFICACIONES -->
        <div *ngIf="seccionSeleccionada === 'notificaciones'">
          <h3 class="mb-3 fw-bold">Notificaciones</h3>
          <hr class="mb-4" />
          <p>prueba</p>
        </div>

        <!-- AYUDA Y COMENTARIOS -->
        <div *ngIf="seccionSeleccionada === 'ayudaComentarios'">
          <h3 class="mb-3 fw-bold">Ayuda y Comentarios</h3>
          <hr class="mb-4" />

          <div class="mb-5">
            <h4>Soporte para Proveedores</h4>
            <div class="accordion" id="faqAccordion">
              <div class="accordion-item">
                <h2 class="accordion-header" id="faq1">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFaq1"
                    aria-expanded="false"
                    aria-controls="collapseFaq1"
                  >
                    ¿Cómo puedo agregar o modificar mis servicios?
                  </button>
                </h2>
                <div
                  id="collapseFaq1"
                  class="accordion-collapse collapse"
                  aria-labelledby="faq1"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    Puedes gestionar tus servicios desde la pestaña "Mis
                    Servicios". Ahí puedes añadir nuevas experiencias, editar
                    las existentes y actualizar precios o descripciones.
                  </div>
                </div>
              </div>

              <div class="accordion-item">
                <h2 class="accordion-header" id="faq2">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFaq2"
                    aria-expanded="false"
                    aria-controls="collapseFaq2"
                  >
                    ¿Cómo actualizo la disponibilidad de mis servicios?
                  </button>
                </h2>
                <div
                  id="collapseFaq2"
                  class="accordion-collapse collapse"
                  aria-labelledby="faq2"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    La disponibilidad se actualiza automáticamente en función de
                    las reservas confirmadas. También puedes modificar
                    manualmente la disponibilidad en la sección de cada
                    servicio.
                  </div>
                </div>
              </div>

              <div class="accordion-item">
                <h2 class="accordion-header" id="faq3">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFaq3"
                    aria-expanded="false"
                    aria-controls="collapseFaq3"
                  >
                    ¿Cómo puedo gestionar cancelaciones y reprogramaciones?
                  </button>
                </h2>
                <div
                  id="collapseFaq3"
                  class="accordion-collapse collapse"
                  aria-labelledby="faq3"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    Desde la plataforma podrás gestionar cancelaciones o
                    reprogramaciones con notificaciones en tiempo real para
                    garantizar una respuesta rápida a tus clientes.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="mb-5">
            <h4>Recomendaciones para Optimizar tu Perfil</h4>
            <ul>
              <li>
                Mantén actualizada la información y disponibilidad de tus
                servicios para evitar conflictos de reserva.
              </li>
              <li>
                Responde oportunamente a las consultas y solicitudes de los
                viajeros para mejorar tu reputación.
              </li>
              <li>
                Ofrece descripciones claras y fotos atractivas para aumentar la
                reserva de tus experiencias.
              </li>
            </ul>
          </div>

          <div class="mb-5">
            <h4>Contacto y Soporte</h4>
            <p>
              Si necesitas asistencia adicional, puedes comunicarte con nuestro
              equipo de soporte especializado para proveedores:
            </p>
            <ul class="list-unstyled">
              <li>
                <i class="bi bi-envelope-fill me-2"></i
                ><strong>Email:</strong> soporte-proveedores&#64;expedia.com
              </li>
              <li>
                <i class="bi bi-telephone-fill me-2"></i
                ><strong>Teléfono:</strong> +1 (800) 987-6543
              </li>
              <li>
                <i class="bi bi-clock-fill me-2"></i
                ><strong>Horario de atención:</strong> Lunes a Viernes, 9:00 a
                18:00 (GMT-4)
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
